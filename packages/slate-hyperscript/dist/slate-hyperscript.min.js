!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("slate")):"function"==typeof define&&define.amd?define(["exports","slate"],t):t(e.SlateHyperscript={},e.Slate)}(this,function(e,t){"use strict";var n=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)};function o(e){return!0===n(e)&&"[object Object]"===Object.prototype.toString.call(e)}var r=function(e){var t,n;return!1!==o(e)&&("function"==typeof(t=e.constructor)&&(!1!==o(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))},i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},s=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},c=0;function f(e,t,n){return new x(t)}function u(e,t,n){return _("node",a({},t,{object:"block"}),n)}function d(e,t,n){return new w(t)}function l(e,t,n){var o=t.key,r=t.data,i=e;if(o)return new j({id:o,type:i,data:r});var a=p("leaves",{},n),s=a.first(),f=a.last(),u="__decoration_"+c+++"__",d=new j({id:u,type:i,data:r}),l=new j({id:u,type:i,data:r});return E(s,d,0),E(f,l,f.text.length),a}function h(e,t,n){return _("node",a({},t,{object:"document"}),n)}function v(e,t,n){return new S(t)}function y(e,t,n){return _("node",a({},t,{object:"inline"}),n)}function p(e,n,o){var r=n.marks,i=void 0===r?t.Mark.createSet():r,a=0,s=t.Leaf.createList([]),c=void 0;return o.forEach(function(e){if(t.Leaf.isLeafList(e))c&&(s=s.push(c),c=null),e.forEach(function(e){e=O(e,function(e){return e.addMarks(i)}),s=s.push(e)});else{if(c||(c=t.Leaf.create({marks:i,text:""}),a=0),"string"==typeof e){var n=c.text.length;c=O(c,function(t){return t.insertText(n,e)}),a+=e.length}((o=e)instanceof x||o instanceof w||o instanceof j||o instanceof S)&&E(c,e,a)}var o}),s.size||c||(c=t.Leaf.create({marks:i,text:""})),c&&(s=s.push(c)),s}function k(e,n,o){return p(0,{marks:t.Mark.createSet([n])},o)}function _(e,n,o){if("text"===n.object)return b("text",{},o);var r=[],i=[];if(o.forEach(function(e){if(t.Node.isNode(e)){if(i.length){var n=b("text",{},i);r.push(n)}r.push(e),i=[]}else i.push(e)}),i.length){var s=b("text",{},i);r.push(s)}return t.Node.create(a({},n,{nodes:r}))}function m(e,n,o){var r=o.find(function(e){return e instanceof x}),i=o.find(function(e){return e instanceof S}),a=n.marks,s=n.focused;return t.Selection.create({marks:a,isFocused:s,anchor:r&&{key:r.key,offset:r.offset,path:r.path},focus:i&&{key:i.key,offset:i.offset,path:i.path}})}function b(e,n,o){var r=n.key,i=p(0,{},o),a=t.Text.create({key:r,leaves:i}),s=0;return i.forEach(function(e){!function(e,t){var n=e.__anchor,o=e.__focus,r=e.__decorations;null!=n&&(n.offset+=t);null!=o&&o!==n&&(o.offset+=t);null!=r&&r.forEach(function(e){return e.offset+=t})}(e,s),O(e,function(){return a}),s+=e.text.length}),a}function g(e,n,o){var r=n.data,i=o.find(t.Document.isDocument),s=o.find(t.Selection.isSelection),c=void 0,f=void 0,u=void 0,d=void 0,l=[],h={};if(i&&i.getTexts().forEach(function(e){var n=e.__anchor,o=e.__decorations,r=e.__focus;if(null!=n&&(c=t.Point.create({key:e.key,offset:n.offset}),u=n.marks,d=n.isFocused),null!=r&&(f=t.Point.create({key:e.key,offset:r.offset}),u=r.marks,d=r.isFocused),null!=o){var i=!0,a=!1,s=void 0;try{for(var v,y=o[Symbol.iterator]();!(i=(v=y.next()).done);i=!0){var p=v.value,k=p.id,_=h[k];if(delete h[k],_){var m=t.Decoration.create({anchor:{key:_.key,offset:_.offset},focus:{key:e.key,offset:p.offset},mark:{type:p.type,data:p.data}});l.push(m)}else p.key=e.key,h[k]=p}}catch(e){a=!0,s=e}finally{try{!i&&y.return&&y.return()}finally{if(a)throw s}}}}),Object.keys(h).length>0)throw new Error("Slate hyperscript must have both a start and an end defined for each decoration using the `key=` prop.");if(c&&!f)throw new Error("Slate hyperscript ranges must have both `<anchor />` and `<focus />` defined if one is defined, but you only defined `<anchor />`. For collapsed selections, use `<cursor />` instead.");if(!c&&f)throw new Error("Slate hyperscript ranges must have both `<anchor />` and `<focus />` defined if one is defined, but you only defined `<focus />`. For collapsed selections, use `<cursor />` instead.");return c||f?s=s?s.setPoints([c,f]):t.Selection.create({anchor:c,focus:f,isFocused:d,marks:u}):s||(s=t.Selection.create()),s=s.normalize(i),l.length>0&&(l=l.map(function(e){return e.normalize(i)})),t.Value.fromJSON(a({data:r,decorations:l,document:i,selection:s},n))}var w=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e);var n=t.isFocused,o=void 0===n||n,r=t.marks,a=void 0===r?null:r;this.isFocused=o,this.marks=a,this.offset=null},x=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e);var n=t.isFocused,o=void 0===n||n,r=t.key,a=void 0===r?null:r,s=t.marks,c=void 0===s?null:s,f=t.offset,u=void 0===f?null:f,d=t.path,l=void 0===d?null:d;this.isFocused=o,this.key=a,this.marks=c,this.offset=u,this.path=l},S=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e);var n=t.isFocused,o=void 0===n||n,r=t.key,a=void 0===r?null:r,s=t.marks,c=void 0===s?null:s,f=t.offset,u=void 0===f?null:f,d=t.path,l=void 0===d?null:d;this.isFocused=o,this.key=a,this.marks=c,this.offset=u,this.path=l},j=function e(t){i(this,e);var n=t.id,o=void 0===n?null:n,r=t.data,a=void 0===r?{}:r,s=t.type;this.id=o,this.offset=null,this.type=s,this.data=a};function O(e,t){var n=e.__anchor,o=e.__focus,r=e.__decorations,i=t(e);return null!=n&&(i.__anchor=n),null!=o&&(i.__focus=o),null!=r&&(i.__decorations=r),i}function E(e,t,n){(t instanceof x||t instanceof w)&&(t.offset=n,e.__anchor=t),(t instanceof S||t instanceof w)&&(t.offset=n,e.__focus=t),t instanceof j&&(t.offset=n,e.__decorations=e.__decorations||[],e.__decorations=e.__decorations.concat(t))}function F(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.blocks,n=void 0===t?{}:t,o=e.inlines,i=void 0===o?{}:o,s=e.marks,c=void 0===s?{}:s,p=e.decorations,w=void 0===p?{}:p,x=a({anchor:f,block:u,cursor:d,decoration:l,document:h,focus:v,inline:y,mark:k,node:_,selection:m,text:b,value:g},e.creators||{});for(var S in n)x[S]=P(n[S],u);for(var j in i)x[j]=P(i[j],y);for(var O in c)x[O]=P(c[O],k);for(var E in w)x[E]=P(w[E],l);return function(e,t){for(var n=arguments.length,o=Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];var a=x[e];if(!a)throw new Error('No hyperscript creator found for tag: "'+e+'"');return null==t&&(t={}),r(t)||(o=[t].concat(o),t={}),a(e,t,o=o.filter(function(e){return Boolean(e)}).reduce(function(e,t){return e.concat(t)},[]))}}function P(e,t){if("function"==typeof e)return e;if("string"==typeof e&&(e={type:e}),r(e))return function(n,o,r){var i=o.key,c=s(o,["key"]),f=a({},e,{key:i,data:a({},e.data||{},c)});return t(n,f,r)};throw new Error("Slate hyperscript creators can be either functions, objects or strings, but you passed: "+e)}var L=F();e.default=L,e.createHyperscript=F,Object.defineProperty(e,"__esModule",{value:!0})});
